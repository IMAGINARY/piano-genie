{"version":3,"sources":["node_modules/browser-pack/_prelude.js","js/main.js","js/piano-genie.js","node_modules/qs/lib/formats.js","node_modules/qs/lib/index.js","node_modules/qs/lib/parse.js","node_modules/qs/lib/stringify.js","node_modules/qs/lib/utils.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","_qs","_pianoGenie","_main","defaultConfig","defaultLanguage","showInfoButton","showConfigButton","showFullScreenButton","showInputKeys","showInputKeysText","showInputInstructions","keyCount","input","output","loadConfig","_callee2","uri","response","regeneratorRuntime","wrap","_context2","prev","next","fetch","cache","sent","status","json","abrupt","t0","concat","message","statusText","stop","_asyncToGenerator","mark","_callee","qsArgs","config","_context","parse","window","location","search","ignoreQueryPrefix","Object","t1","t2","t3","assign","undefined","embed","embedMode","IMAGINARY","i18n","init","queryStringVariable","translationsDirectory","initPianoGenie","document","querySelectorAll","forEach","element","innerHTML","getAttribute","t4","console","error","apply","this","arguments","options","CONSTANTS","COLORS","NUM_BUTTONS","NOTES_PER_OCTAVE","WHITE_NOTES_PER_OCTAVE","LOWEST_PIANO_KEY_MIDI_NOTE","NUM_NOTES","GENIE_CHECKPOINT","Player","_classCallCheck","player","mm","SoundFontPlayer","midiOut","midiIn","usingMidiOut","usingMidiIn","selectOutElement","getElementById","selectInElement","loadAllSamples","_createClass","key","value","seq","notes","push","pitch","loadSamples","button","sendMidiNoteOn","tone","context","resume","playNoteDown","sendMidiNoteOff","playNoteUp","midi","_this","addEventListener","event","initDevices","target","_this2","outputs","values","done","inputs","onmidimessage","msg","getMIDIMessage","map","device","name","join","selectedIndex","send","command","data","buttonDown","buttonUp","FloatyNotes","canvas","getContext","lineWidth","lineCap","contextHeight","whiteNoteHeight","width","innerWidth","height","innerHeight","x","noteToPaint","parseFloat","y","color","on","_this3","clearRect","filter","note","globalAlpha","fillStyle","fillRect","requestAnimationFrame","drawLoop","Piano","whiteNoteWidth","blackNoteWidth","blackNoteHeight","svg","svgNS","totalWhiteNotes","ratio","OCTAVES","Math","floor","setAttribute","halfABlackNote","index","blackNoteIndexes","makeRect","indexOf","_o","_i","rect","querySelector","log","removeAttribute","w","h","fill","stroke","createElementNS","appendChild","showFocusTip","classList","add","keyWhitelist","MAPPING_8","0","2","3","4","5","6","7","MAPPING_4","KEYCODES_NUMBERS","KEYCODES_STD","KEYCODES_MAKEY","BUTTON_MAPPING","TEMPERATURE","getTemperature","heldButtonToVisualData","Map","sustaining","sustainingNotes","inputsForButtons","genie","PianoGenie","painter","piano","isUsingMakey","updateNumButtons","num","buttons","hidden","preprocessPointerEvent","preventDefault","buttonId","dataset","id","inputString","pointerId","doPointerStart","doInputStart","doPointerEnd","doInputEnd","_ref","has","set","Set","inputsForButton","get","size","_ref2","el","nextFromKeyWhitelist","highlightNote","addNote","thing","clearNote","stopNote","onKeyDown","repeat","resetState","getButtonFromKeyCode","onKeyUp","onWindowResize","bonusNotes","totalNotes","Array","resize","draw","hash","params","substring","split","hk","temp","newTemp","min","updateButtonText","btns","display","style","initialize","then","filterActivePointer","cb","noop","_step","_iterator","_createForOfIteratorHelper","s","err","radioMidiOutYes","midiOutBox","radioAudioYes","click","radioMidiInYes","midiInBox","radioDeviceYes","radioMakeyYes","navigator","requestMIDIAccess","midiNotSupported","parentElement","midiReady","showMainScreen","checked","remove","hasFocus","infoBox","settingsBox","body","requestFullscreen","fullscreenElement","exitFullscreen","alert","replace","String","prototype","percentTwenties","util","Format","RFC1738","RFC3986","default","formatters","stringify","formats","parseArrayValue","val","comma","parseValues","str","part","bracketEqualsPos","pos","obj","cleanStr","limit","parameterLimit","Infinity","parts","delimiter","skipIndex","charset","charsetSentinel","decoder","defaults","strictNullHandling","slice","utils","maybeMap","encodedVal","interpretNumericEntities","$0","numberStr","fromCharCode","parseInt","isArray","combine","parseKeys","givenKey","valuesParsed","allowDots","child","segment","depth","exec","parent","keys","plainObjects","allowPrototypes","chain","leaf","cleanRoot","root","parseArrays","create","charAt","isNaN","arrayLimit","parseObject","hasOwnProperty","decode","opts","TypeError","isRegExp","normalizeParseOptions","tempObj","newObj","merge","compact","pushToArray","arr","valueOrArray","object","prefix","generateArrayPrefix","skipNulls","encoder","sort","serializeDate","formatter","encodeValuesOnly","v","Date","isBuffer","objKeys","keyPrefix","arrayPrefixGenerators","brackets","indices","toISO","toISOString","defaultFormat","addQueryPrefix","encode","format","date","normalizeStringifyOptions","arrayFormat","joined","arrayToObject","source","hexTable","array","toString","toUpperCase","reduce","acc","b","queue","prop","refs","item","j","pop","compacted","compactQueue","strWithoutPlus","unescape","decodeURIComponent","defaultEncoder","string","Symbol","escape","out","charCodeAt","constructor","fn","mapped","mergeTarget","targetItem"],"mappings":"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","file":"bundle.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/* globals IMAGINARY */\nimport qs from 'qs';\nimport { initPianoGenie } from './piano-genie';\n\nconst defaultConfig = {\n  defaultLanguage: 'en',\n  showInfoButton: true,\n  showConfigButton: true,\n  showFullScreenButton: true,\n  showInputKeys: true,\n  showInputKeysText: true,\n  showInputInstructions: true,\n  keyCount: 8,\n  input: 'keyboard',\n  output: 'wave',\n};\n\n/**\n * Loads the config file from an external JSON file\n *\n * @param {String} uri\n * @return {Promise<any>}\n */\nasync function loadConfig(uri) {\n  const response = await fetch(uri, { cache: 'no-store' });\n  if (response.status >= 200 && response.status < 300) {\n    try {\n      return await response.json();\n    } catch (e) {\n      throw new Error(`Error parsing config file: ${e.message}`);\n    }\n  }\n  if (response.status === 404) {\n    return {};\n  }\n  throw new Error(`Server returned status ${response.status} (${response.statusText}) loading config file.`);\n}\n\n/**\n * Load config files and start the program\n */\n(async function main() {\n  try {\n    const qsArgs = qs.parse(window.location.search, { ignoreQueryPrefix: true });\n    const config = Object.assign({}, defaultConfig, await loadConfig('./config.json'));\n\n    if (qsArgs.embed !== undefined) {\n      config.embedMode = true;\n    }\n\n    await IMAGINARY.i18n.init({\n      queryStringVariable: 'lang',\n      translationsDirectory: 'tr',\n      defaultLanguage: config.defaultLanguage || 'en',\n    });\n\n    initPianoGenie(config);\n\n    document.querySelectorAll('[data-i18n-field]').forEach((element) => {\n      element.innerHTML = IMAGINARY.i18n.t(element.getAttribute('data-i18n-field'));\n    });\n  } catch (err) {\n    // eslint-disable-next-line no-console\n    console.error(err);\n  }\n}());\n","/* globals IMAGINARY */\n\nexport function initPianoGenie(options) {\n\n  const CONSTANTS = {\n    COLORS : ['#db4c67','#ff8459','#ffec02','#73ff6c',\n      '#00c5ba','#3753be','#9c52ff','#ef71f2'],\n    NUM_BUTTONS : 8,\n    NOTES_PER_OCTAVE : 12,\n    WHITE_NOTES_PER_OCTAVE : 7,\n    LOWEST_PIANO_KEY_MIDI_NOTE : 21,\n    NUM_NOTES: 88,\n    GENIE_CHECKPOINT : 'model/genie',\n  }\n\n  /*************************\n   * MIDI or Magenta player\n   ************************/\n  class Player {\n    constructor() {\n      this.player = new mm.SoundFontPlayer('vendor/sgm_plus');\n      this.midiOut = [];\n      this.midiIn = []\n      this.usingMidiOut = false;\n      this.usingMidiIn = false;\n      this.selectOutElement = document.getElementById('selectOut');\n      this.selectInElement = document.getElementById('selectIn');\n      this.loadAllSamples();\n    }\n\n    loadAllSamples() {\n      const seq = {notes:[]};\n      for (let i = 0; i < CONSTANTS.NUM_NOTES; i++) {\n        seq.notes.push({pitch: CONSTANTS.LOWEST_PIANO_KEY_MIDI_NOTE + i});\n      }\n      this.player.loadSamples(seq);\n    }\n\n    playNoteDown(pitch, button) {\n      // Send to MIDI out or play with the Magenta player.\n      if (this.usingMidiOut) {\n        this.sendMidiNoteOn(pitch, button);\n      } else {\n        mm.Player.tone.context.resume();\n        this.player.playNoteDown({pitch:pitch});\n      }\n    }\n\n    playNoteUp(pitch, button) {\n      // Send to MIDI out or play with the Magenta player.\n      if (this.usingMidiOut) {\n        this.sendMidiNoteOff(pitch, button);\n      } else {\n        this.player.playNoteUp({pitch:pitch});\n      }\n    }\n\n    // MIDI bits.\n    midiReady(midi) {\n      // Also react to device changes.\n      midi.addEventListener('statechange', (event) => this.initDevices(event.target));\n      this.initDevices(midi);\n    }\n\n    initDevices(midi) {\n      this.midiOut = [];\n      this.midiIn = [];\n\n\n      const outputs = midi.outputs.values();\n      for (let output = outputs.next(); output && !output.done; output = outputs.next()) {\n        this.midiOut.push(output.value);\n      }\n\n      const inputs = midi.inputs.values();\n      for (let input = inputs.next(); input && !input.done; input = inputs.next()) {\n        this.midiIn.push(input.value);\n        // TODO: should probably use the selected index from this.selectInElement for correctness\n        // but i'm hacking this together for a demo so...\n        input.value.onmidimessage = (msg) => this.getMIDIMessage(msg);\n\n      }\n\n      // No MIDI, no settings.\n      //btnSettings.hidden = (this.midiOut.length === 0 && this.midiIn.length === 0);\n      this.selectInElement.innerHTML = this.midiIn.map(device => `<option>${device.name}</option>`).join('');\n      this.selectOutElement.innerHTML = this.midiOut.map(device => `<option>${device.name}</option>`).join('');\n    }\n\n    sendMidiNoteOn(pitch, button) {\n      // -1 is sent when releasing the sustain pedal.\n      if (button === -1) button = 0;\n      //const msg = [0x90 + button, pitch, 0x7f];    // note on, full velocity.\n      const msg = [0x90, pitch, 0x7f];    // note on, full velocity.\n      this.midiOut[this.selectOutElement.selectedIndex].send(msg);\n    }\n\n    sendMidiNoteOff(pitch, button) {\n      // -1 is sent when releasing the sustain pedal.\n      if (button === -1) button = 0;\n      //const msg = [0x80 + button, pitch, 0x7f];    // note on, middle C, full velocity.\n      const msg = [0x80, pitch, 0x7f];    // note on, middle C, full velocity.\n      this.midiOut[this.selectOutElement.selectedIndex].send(msg);\n    }\n\n    getMIDIMessage(msg) {\n      if (!this.usingMidiIn) {\n        return;\n      }\n      const command = msg.data[0];\n      const button = msg.data[1];\n      const velocity = (msg.data.length > 2) ? msg.data[2] : 0; // a velocity value might not be included with a noteOff command\n\n      switch (command) {\n        case 0x90: // note on\n          buttonDown(button, false);\n          break;\n        case 0x80: // note off\n          buttonUp(button);\n          break;\n      }\n    }\n  }\n\n  /*************************\n   * Floaty notes\n   ************************/\n  class FloatyNotes {\n    constructor() {\n      this.notes = [];  // the notes floating on the screen.\n\n      this.canvas = document.getElementById('canvas')\n      this.context = this.canvas.getContext('2d');\n      this.context.lineWidth = 4;\n      this.context.lineCap = 'round';\n\n      this.contextHeight = 0;\n    }\n\n    resize(whiteNoteHeight) {\n      this.canvas.width = window.innerWidth;\n      this.canvas.height = this.contextHeight = window.innerHeight - whiteNoteHeight - 20;\n    }\n\n    addNote(button, x, width) {\n      const noteToPaint = {\n        x: parseFloat(x),\n        y: 0,\n        width: parseFloat(width),\n        height: 0,\n        color: CONSTANTS.COLORS[button],\n        on: true\n      };\n      this.notes.push(noteToPaint);\n      return noteToPaint;\n    }\n\n    stopNote(noteToPaint) {\n      noteToPaint.on = false;\n    }\n\n    drawLoop() {\n      const dy = 3;\n      this.context.clearRect(0, 0, window.innerWidth, window.innerHeight);\n\n      // Remove all the notes that will be off the page;\n      this.notes = this.notes.filter((note) => note.on || note.y < (this.contextHeight - 100));\n\n      // Advance all the notes.\n      for (let i = 0; i < this.notes.length; i++) {\n        const note = this.notes[i];\n\n        // If the note is still on, then its height goes up but it\n        // doesn't start sliding down yet.\n        if (note.on) {\n          note.height += dy;\n        } else {\n          note.y += dy;\n        }\n\n        this.context.globalAlpha = 1 - note.y / this.contextHeight;\n        this.context.fillStyle = note.color;\n        this.context.fillRect(note.x, note.y, note.width, note.height);\n      }\n      window.requestAnimationFrame(() => this.drawLoop());\n    }\n  }\n\n  class Piano {\n    constructor() {\n      this.config = {\n        whiteNoteWidth: 20,\n        blackNoteWidth: 20,\n        whiteNoteHeight: 70,\n        blackNoteHeight: 2 * 70 / 3\n      }\n\n      this.svg = document.getElementById('svg');\n      this.svgNS = 'http://www.w3.org/2000/svg';\n    }\n\n    resize(totalWhiteNotes) {\n      // i honestly don't know why some flooring is good and some is bad sigh.\n      const ratio = window.innerWidth / totalWhiteNotes;\n      this.config.whiteNoteWidth = OCTAVES > 6 ? ratio: Math.floor(ratio);\n      this.config.blackNoteWidth = this.config.whiteNoteWidth * 2 / 3;\n      this.svg.setAttribute('width', window.innerWidth);\n      this.svg.setAttribute('height', this.config.whiteNoteHeight);\n    }\n\n    draw() {\n      this.svg.innerHTML = '';\n      const halfABlackNote = this.config.blackNoteWidth / 2;\n      let x = 0;\n      let y = 0;\n      let index = 0;\n\n      const blackNoteIndexes = [1, 3, 6, 8, 10];\n\n      // First draw all the white notes.\n      // Pianos start on an A (if we're using all the octaves);\n      if (OCTAVES > 6) {\n        this.makeRect(0, x, y, this.config.whiteNoteWidth, this.config.whiteNoteHeight, 'white', '#141E30');\n        this.makeRect(2, this.config.whiteNoteWidth, y, this.config.whiteNoteWidth, this.config.whiteNoteHeight, 'white', '#141E30');\n        index = 3;\n        x = 2 * this.config.whiteNoteWidth;\n      } else {\n        // Starting 3 semitones up on small screens (on a C), and a whole octave up.\n        index = 3 + CONSTANTS.NOTES_PER_OCTAVE;\n      }\n\n      // Draw the white notes.\n      for (let o = 0; o < OCTAVES; o++) {\n        for (let i = 0; i < CONSTANTS.NOTES_PER_OCTAVE; i++) {\n          if (blackNoteIndexes.indexOf(i) === -1) {\n            this.makeRect(index, x, y, this.config.whiteNoteWidth, this.config.whiteNoteHeight, 'white', '#141E30');\n            x += this.config.whiteNoteWidth;\n          }\n          index++;\n        }\n      }\n\n      if (OCTAVES > 6) {\n        // And an extra C at the end (if we're using all the octaves);\n        this.makeRect(index, x, y, this.config.whiteNoteWidth, this.config.whiteNoteHeight, 'white', '#141E30');\n\n        // Now draw all the black notes, so that they sit on top.\n        // Pianos start on an A:\n        this.makeRect(1, this.config.whiteNoteWidth - halfABlackNote, y, this.config.blackNoteWidth, this.config.blackNoteHeight, 'black');\n        index = 3;\n        x = this.config.whiteNoteWidth;\n      } else {\n        // Starting 3 semitones up on small screens (on a C), and a whole octave up.\n        index = 3 + CONSTANTS.NOTES_PER_OCTAVE;\n        x = -this.config.whiteNoteWidth;\n      }\n\n      // Draw the black notes.\n      for (let o = 0; o < OCTAVES; o++) {\n        for (let i = 0; i < CONSTANTS.NOTES_PER_OCTAVE; i++) {\n          if (blackNoteIndexes.indexOf(i) !== -1) {\n            this.makeRect(index, x + this.config.whiteNoteWidth - halfABlackNote, y, this.config.blackNoteWidth, this.config.blackNoteHeight, 'black');\n          } else {\n            x += this.config.whiteNoteWidth;\n          }\n          index++;\n        }\n      }\n    }\n\n    highlightNote(note, button) {\n      // Show the note on the piano roll.\n      const rect = this.svg.querySelector(`rect[data-index=\"${note}\"]`);\n      if (!rect) {\n        console.log('couldnt find a rect for note', note);\n        return;\n      }\n      rect.setAttribute('active', true);\n      rect.setAttribute('class', `color-${button}`);\n      return rect;\n    }\n\n    clearNote(rect) {\n      rect.removeAttribute('active');\n      rect.removeAttribute('class');\n    }\n\n    makeRect(index, x, y, w, h, fill, stroke) {\n      const rect = document.createElementNS(this.svgNS, 'rect');\n      rect.setAttribute('data-index', index);\n      rect.setAttribute('x', x);\n      rect.setAttribute('y', y);\n      rect.setAttribute('width', w);\n      rect.setAttribute('height', h);\n      rect.setAttribute('fill', fill);\n      if (stroke) {\n        rect.setAttribute('stroke', stroke);\n        rect.setAttribute('stroke-width', '3px');\n      }\n      this.svg.appendChild(rect);\n      return rect;\n    }\n  }\n\n  function showFocusTip() {\n    document.querySelector('.embed-focus-tip').classList.add('visible');\n  }\n\n  function hideFocusTip() {\n    document.querySelector('.embed-focus-tip').classList.remove('visible');\n  }\n\n  /*************************\n   * Consts for everyone!\n   ************************/\n// button mappings.\n  const MAPPING_8 = {0:0, 1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7};\n  const MAPPING_4 = {0:0, 1:2, 2:5, 3:7, 4:0, 5:2, 6:5, 7:7};\n  const KEYCODES_NUMBERS = ['Digit1', 'Digit2', 'Digit3', 'Digit4', 'Digit5', 'Digit6', 'Digit7', 'Digit8'];\n  const KEYCODES_STD = ['KeyA', 'KeyS', 'KeyD', 'KeyF', 'KeyJ', 'KeyK', 'KeyL', 'Semicolon'];\n  const KEYCODES_MAKEY = ['ArrowUp','ArrowLeft','ArrowDown','ArrowRight', 'KeyW', 'KeyA', 'KeyS', 'KeyD'];\n\n  let OCTAVES = 7;\n  let NUM_BUTTONS = options.keyCount === 4 ? 4 : 8;\n  let BUTTON_MAPPING = MAPPING_8;\n\n  let keyWhitelist;\n  let TEMPERATURE = getTemperature();\n\n  const heldButtonToVisualData = new Map();\n\n// Which notes the pedal is sustaining.\n  let sustaining = false\n  let sustainingNotes = [];\n\n  const inputsForButtons = new Map();\n\n  const player = new Player();\n  const genie = new mm.PianoGenie(CONSTANTS.GENIE_CHECKPOINT);\n  const painter = new FloatyNotes();\n  const piano = new Piano();\n  let isUsingMakey = false;\n  initEverything();\n\n  /*************************\n   * Basic UI bits\n   ************************/\n  function initEverything() {\n    genie.initialize().then(() => {\n      console.log('🧞‍♀️ ready!');\n      // playBtn.textContent = 'Play';\n      // playBtn.removeAttribute('disabled');\n      // playBtn.classList.remove('loading');\n      showMainScreen();\n    });\n\n    // Start the drawing loop.\n    onWindowResize();\n    updateButtonText();\n    window.requestAnimationFrame(() => painter.drawLoop());\n\n    // Event listeners.\n    document.getElementById('numButtons4').addEventListener('change', (event) => event.target.checked && updateNumButtons(4));\n    document.getElementById('numButtons8').addEventListener('change', (event) => event.target.checked && updateNumButtons(8));\n    document.getElementById('numButtons4').checked = (NUM_BUTTONS === 4);\n    document.getElementById('numButtons8').checked = (NUM_BUTTONS !== 4);\n    updateNumButtons(NUM_BUTTONS);\n\n    window.addEventListener('resize', onWindowResize);\n    window.addEventListener('orientationchange', onWindowResize);\n    window.addEventListener('hashchange', () => TEMPERATURE = getTemperature());\n\n    if(options.embedMode) {\n      window.addEventListener('focus', () => { hideFocusTip(); });\n      window.addEventListener('blur', () => { showFocusTip(); });\n      if (!document.hasFocus()) {\n        showFocusTip();\n      }\n    }\n  }\n\n  function updateNumButtons(num) {\n    NUM_BUTTONS = num;\n    const buttons = document.querySelectorAll('.controls > .keyboard > button.color');\n    BUTTON_MAPPING = (num === 4) ? MAPPING_4 : MAPPING_8;\n\n    // Hide the extra buttons.\n    for (let i = 0; i < buttons.length; i++) {\n      buttons[i].hidden = i >= num;\n    }\n  }\n\n  function showMainScreen() {\n    document.querySelector('.splash').hidden = true;\n    document.querySelector('.loaded').hidden = false;\n\n    document.addEventListener('keydown',onKeyDown);\n\n    const noop = () => {};\n    const filterActivePointer = (cb) => e => e.buttons !== 0 ? cb(e) : noop();\n    const buttons = document.querySelectorAll(\".keyboard button.color\");\n    for(const button of buttons) {\n      button.addEventListener('pointercancel', doPointerStart);\n      button.addEventListener('pointerdown', doPointerStart);\n      button.addEventListener('pointerup', doPointerEnd);\n      button.addEventListener('pointerover', filterActivePointer(doPointerStart));\n      button.addEventListener('pointerout', filterActivePointer(doPointerEnd));\n    }\n\n    // Output.\n    radioMidiOutYes.addEventListener('click', () => {\n      player.usingMidiOut = true;\n      midiOutBox.hidden = false;\n    });\n    radioAudioYes.addEventListener('click', () => {\n      player.usingMidiOut = false;\n      midiOutBox.hidden = true;\n    });\n\n    if (options.output === 'wave') {\n      radioAudioYes.click();\n    } else if (options.output === 'midi') {\n      radioMidiOutYes.click();\n    }\n\n    // Input.\n    radioMidiInYes.addEventListener('click', () => {\n      player.usingMidiIn = true;\n      midiInBox.hidden = false;\n      isUsingMakey = false;\n      updateButtonText();\n    });\n    radioDeviceYes.addEventListener('click', () => {\n      player.usingMidiIn = false;\n      midiInBox.hidden = true;\n      isUsingMakey = false;\n      updateButtonText();\n    });\n    radioMakeyYes.addEventListener('click', () => {\n      player.usingMidiIn = false;\n      midiInBox.hidden = true;\n      isUsingMakey = true;\n      updateButtonText();\n    });\n\n    if (options.input === 'keyboard') {\n      radioDeviceYes.click();\n    } else if (options.input === 'makey') {\n      radioMakeyYes.click();\n    } else if (options.input === 'midi') {\n      radioMidiInYes.click();\n    }\n\n    // Figure out if WebMidi works.\n    if (navigator.requestMIDIAccess) {\n      midiNotSupported.hidden = true;\n      radioMidiInYes.parentElement.removeAttribute('disabled');\n      radioMidiOutYes.parentElement.removeAttribute('disabled');\n      navigator.requestMIDIAccess()\n        .then(\n          (midi) => player.midiReady(midi),\n          (err) => console.log('Something went wrong', err));\n    } else {\n      midiNotSupported.hidden = false;\n      radioMidiInYes.parentElement.setAttribute('disabled', true);\n      radioMidiOutYes.parentElement.setAttribute('disabled', true);\n    }\n\n    document.addEventListener('keyup', onKeyUp);\n\n    // Slow to start up, so do a fake prediction to warm up the model.\n    const note = genie.nextFromKeyWhitelist(0, keyWhitelist, TEMPERATURE);\n    genie.resetState();\n  }\n\n  function preprocessPointerEvent(event) {\n    event.preventDefault();\n    const buttonId = event.target.dataset.id;\n    const inputString = `pointer_${event.pointerId}`;\n    return {buttonId, inputString};\n  }\n\n  // Here pointer means either touch or mouse.\n  function doPointerStart(event) {\n    doInputStart(preprocessPointerEvent(event));\n  }\n  function doPointerEnd(event) {\n    doInputEnd(preprocessPointerEvent(event));\n  }\n\n  function doInputStart({buttonId, inputString}) {\n    if(!inputsForButtons.has(buttonId)) {\n      inputsForButtons.set(buttonId, new Set());\n    }\n    const inputsForButton = inputsForButtons.get(buttonId);\n    if(inputsForButton.size === 0) {\n      buttonDown(buttonId);\n    }\n    inputsForButton.add(inputString);\n  }\n\n  function doInputEnd({buttonId, inputString}) {\n    if(!inputsForButtons.has(buttonId)) {\n      inputsForButtons.set(buttonId, new Set());\n    }\n    const inputsForButton = inputsForButtons.get(buttonId);\n    inputsForButton.delete(inputString)\n    if(inputsForButton.size === 0) {\n      buttonUp(buttonId);\n    }\n  }\n\n  /*************************\n   * Button actions\n   ************************/\n  function buttonDown(button) {\n    // If we're already holding this button down, nothing new to do.\n    if (heldButtonToVisualData.has(button)) {\n      return;\n    }\n\n    const el = document.getElementById(`btn${button}`);\n    if (!el)\n      return;\n    el.setAttribute('active', true);\n\n    const note = genie.nextFromKeyWhitelist(BUTTON_MAPPING[button], keyWhitelist, TEMPERATURE);\n    const pitch = CONSTANTS.LOWEST_PIANO_KEY_MIDI_NOTE + note;\n\n    // Hear it.\n    player.playNoteDown(pitch, button);\n\n    // See it.\n    const rect = piano.highlightNote(note, button);\n\n    if (!rect) {\n      debugger;\n    }\n    // Float it.\n    const noteToPaint = painter.addNote(button, rect.getAttribute('x'), rect.getAttribute('width'));\n    heldButtonToVisualData.set(button, {rect:rect, note:note, noteToPaint:noteToPaint});\n  }\n\n  function buttonUp(button) {\n    const el = document.getElementById(`btn${button}`);\n    if (!el)\n      return;\n    el.removeAttribute('active');\n\n    const thing = heldButtonToVisualData.get(button);\n    if (thing) {\n      // Don't see it.\n      piano.clearNote(thing.rect);\n\n      // Stop holding it down.\n      painter.stopNote(thing.noteToPaint);\n\n      // Maybe stop hearing it.\n      const pitch = CONSTANTS.LOWEST_PIANO_KEY_MIDI_NOTE + thing.note;\n      if (!sustaining) {\n        player.playNoteUp(pitch, button);\n      } else {\n        sustainingNotes.push(CONSTANTS.LOWEST_PIANO_KEY_MIDI_NOTE + thing.note);\n      }\n    }\n    heldButtonToVisualData.delete(button);\n  }\n\n  /*************************\n   * Events\n   ************************/\n  function onKeyDown(event) {\n    // Keydown fires continuously and we don't want that.\n    if (event.repeat) {\n      return;\n    }\n    if (event.key === ' ') {  // sustain pedal\n      sustaining = true;\n    } else if (event.key === '0' || event.key === 'r') {\n      console.log('🧞‍♀️ resetting!');\n      genie.resetState();\n    } else {\n      const button = getButtonFromKeyCode(event.code);\n      if (button != null) {\n        const buttonId = `${button}`;\n        const inputString = `key_${event.code}`;\n        doInputStart({buttonId, inputString});\n      }\n    }\n  }\n\n  function onKeyUp(event) {\n    if (event.key === ' ') {  // sustain pedal\n      sustaining = false;\n\n      // Release everything.\n      sustainingNotes.forEach((note) => player.playNoteUp(note, -1));\n      sustainingNotes = [];\n    } else {\n      const button = getButtonFromKeyCode(event.code);\n      if (button != null) {\n        const buttonId = `${button}`;\n        const inputString = `key_${event.code}`;\n        doInputEnd({buttonId, inputString});\n      }\n    }\n  }\n\n  function onWindowResize() {\n    OCTAVES = window.innerWidth > 700 ? 7 : 3;\n    const bonusNotes = OCTAVES > 6 ? 4 : 0;  // starts on an A, ends on a C.\n    const totalNotes = CONSTANTS.NOTES_PER_OCTAVE * OCTAVES + bonusNotes;\n    const totalWhiteNotes = CONSTANTS.WHITE_NOTES_PER_OCTAVE * OCTAVES + (bonusNotes - 1);\n    keyWhitelist = Array(totalNotes).fill().map((x,i) => {\n      if (OCTAVES > 6) return i;\n      // Starting 3 semitones up on small screens (on a C), and a whole octave up.\n      return i + 3 + CONSTANTS.NOTES_PER_OCTAVE;\n    });\n\n    piano.resize(totalWhiteNotes);\n    painter.resize(piano.config.whiteNoteHeight);\n    piano.draw();\n  }\n\n  /*************************\n   * Utils and helpers\n   ************************/\n  function getButtonFromKeyCode(code) {\n    let index;\n    if (isUsingMakey) {\n      index = KEYCODES_MAKEY.indexOf(code);\n    } else {\n      index = KEYCODES_NUMBERS.indexOf(code);\n      if (index === -1) {\n        index = KEYCODES_STD.indexOf(code);\n      }\n    }\n    return index !== -1 ? index : null;\n  }\n\n  function getTemperature() {\n    const hash = parseFloat(parseHashParameters()['temperature']) || 0.25;\n    const newTemp = Math.min(1, hash);\n    console.log('🧞‍♀️ temperature = ', newTemp);\n    return newTemp;\n  }\n\n  function parseHashParameters() {\n    const hash = window.location.hash.substring(1);\n    const params = {}\n    hash.split('&').map(hk => {\n      let temp = hk.split('=');\n      params[temp[0]] = temp[1]\n    });\n    return params;\n  }\n\n  function updateButtonText() {\n    const btns = document.querySelectorAll('.controls button.color');\n    const display = IMAGINARY.i18n.t(isUsingMakey ? 'keysMakeyMakey' : 'keys').split(' ');\n    for (let i = 0; i < btns.length; i += 1) {\n      if (options.showInputKeysText) {\n        btns[i].innerHTML = isUsingMakey\n          ? `<span>${display[i]}</span>`\n          : `<span>${i + 1}</span><br><span>${display[i]}</span>`;\n      }\n\n      if (!options.showInputKeys) {\n        btns[i].style.display = 'none';\n      }\n    }\n  }\n\n  document.querySelector('#btnInfo').addEventListener('click', () => {\n    const infoBox = document.querySelector('#infoBox');\n    infoBox.hidden = !infoBox.hidden;\n  });\n\n  if (!options.showInfoButton) {\n    document.querySelector('#btnInfo').style.display = 'none';\n  }\n\n  if (!options.showInputInstructions) {\n    document.querySelector('[data-i18n-field=INFO_INSTRUCTIONS]').style.display = 'none';\n  }\n\n  document.querySelector('#btnSettings').addEventListener('click', () => {\n    const settingsBox = document.querySelector('#settingsBox');\n    settingsBox.hidden = !settingsBox.hidden;\n  });\n\n  if (!options.showConfigButton) {\n    document.querySelector('#btnSettings').style.display = 'none';\n  }\n\n  const body = document.querySelector('body');\n  if (!body.requestFullscreen || !options.showFullScreenButton) {\n    document.querySelector('#btnFullscreen').style.display = 'none';\n  } else {\n    document.querySelector('#btnFullscreen').addEventListener('click', () => {\n      if (!document.fullscreenElement) {\n        body.requestFullscreen().catch((err) => {\n          alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);\n        });\n      } else {\n        document.exitFullscreen();\n      }\n    });\n  }\n}\n","'use strict';\n\nvar replace = String.prototype.replace;\nvar percentTwenties = /%20/g;\n\nvar util = require('./utils');\n\nvar Format = {\n    RFC1738: 'RFC1738',\n    RFC3986: 'RFC3986'\n};\n\nmodule.exports = util.assign(\n    {\n        'default': Format.RFC3986,\n        formatters: {\n            RFC1738: function (value) {\n                return replace.call(value, percentTwenties, '+');\n            },\n            RFC3986: function (value) {\n                return String(value);\n            }\n        }\n    },\n    Format\n);\n","'use strict';\n\nvar stringify = require('./stringify');\nvar parse = require('./parse');\nvar formats = require('./formats');\n\nmodule.exports = {\n    formats: formats,\n    parse: parse,\n    stringify: stringify\n};\n","'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\nvar isArray = Array.isArray;\n\nvar defaults = {\n    allowDots: false,\n    allowPrototypes: false,\n    arrayLimit: 20,\n    charset: 'utf-8',\n    charsetSentinel: false,\n    comma: false,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    ignoreQueryPrefix: false,\n    interpretNumericEntities: false,\n    parameterLimit: 1000,\n    parseArrays: true,\n    plainObjects: false,\n    strictNullHandling: false\n};\n\nvar interpretNumericEntities = function (str) {\n    return str.replace(/&#(\\d+);/g, function ($0, numberStr) {\n        return String.fromCharCode(parseInt(numberStr, 10));\n    });\n};\n\nvar parseArrayValue = function (val, options) {\n    if (val && typeof val === 'string' && options.comma && val.indexOf(',') > -1) {\n        return val.split(',');\n    }\n\n    return val;\n};\n\n// This is what browsers will submit when the ✓ character occurs in an\n// application/x-www-form-urlencoded body and the encoding of the page containing\n// the form is iso-8859-1, or when the submitted form has an accept-charset\n// attribute of iso-8859-1. Presumably also with other charsets that do not contain\n// the ✓ character, such as us-ascii.\nvar isoSentinel = 'utf8=%26%2310003%3B'; // encodeURIComponent('&#10003;')\n\n// These are the percent-encoded utf-8 octets representing a checkmark, indicating that the request actually is utf-8 encoded.\nvar charsetSentinel = 'utf8=%E2%9C%93'; // encodeURIComponent('✓')\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = {};\n    var cleanStr = options.ignoreQueryPrefix ? str.replace(/^\\?/, '') : str;\n    var limit = options.parameterLimit === Infinity ? undefined : options.parameterLimit;\n    var parts = cleanStr.split(options.delimiter, limit);\n    var skipIndex = -1; // Keep track of where the utf8 sentinel was found\n    var i;\n\n    var charset = options.charset;\n    if (options.charsetSentinel) {\n        for (i = 0; i < parts.length; ++i) {\n            if (parts[i].indexOf('utf8=') === 0) {\n                if (parts[i] === charsetSentinel) {\n                    charset = 'utf-8';\n                } else if (parts[i] === isoSentinel) {\n                    charset = 'iso-8859-1';\n                }\n                skipIndex = i;\n                i = parts.length; // The eslint settings do not allow break;\n            }\n        }\n    }\n\n    for (i = 0; i < parts.length; ++i) {\n        if (i === skipIndex) {\n            continue;\n        }\n        var part = parts[i];\n\n        var bracketEqualsPos = part.indexOf(']=');\n        var pos = bracketEqualsPos === -1 ? part.indexOf('=') : bracketEqualsPos + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part, defaults.decoder, charset, 'key');\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos), defaults.decoder, charset, 'key');\n            val = utils.maybeMap(\n                parseArrayValue(part.slice(pos + 1), options),\n                function (encodedVal) {\n                    return options.decoder(encodedVal, defaults.decoder, charset, 'value');\n                }\n            );\n        }\n\n        if (val && options.interpretNumericEntities && charset === 'iso-8859-1') {\n            val = interpretNumericEntities(val);\n        }\n\n        if (part.indexOf('[]=') > -1) {\n            val = isArray(val) ? [val] : val;\n        }\n\n        if (has.call(obj, key)) {\n            obj[key] = utils.combine(obj[key], val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function (chain, val, options, valuesParsed) {\n    var leaf = valuesParsed ? val : parseArrayValue(val, options);\n\n    for (var i = chain.length - 1; i >= 0; --i) {\n        var obj;\n        var root = chain[i];\n\n        if (root === '[]' && options.parseArrays) {\n            obj = [].concat(leaf);\n        } else {\n            obj = options.plainObjects ? Object.create(null) : {};\n            var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n            var index = parseInt(cleanRoot, 10);\n            if (!options.parseArrays && cleanRoot === '') {\n                obj = { 0: leaf };\n            } else if (\n                !isNaN(index)\n                && root !== cleanRoot\n                && String(index) === cleanRoot\n                && index >= 0\n                && (options.parseArrays && index <= options.arrayLimit)\n            ) {\n                obj = [];\n                obj[index] = leaf;\n            } else {\n                obj[cleanRoot] = leaf;\n            }\n        }\n\n        leaf = obj; // eslint-disable-line no-param-reassign\n    }\n\n    return leaf;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options, valuesParsed) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = options.depth > 0 && brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while (options.depth > 0 && (segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options, valuesParsed);\n};\n\nvar normalizeParseOptions = function normalizeParseOptions(opts) {\n    if (!opts) {\n        return defaults;\n    }\n\n    if (opts.decoder !== null && opts.decoder !== undefined && typeof opts.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n    var charset = typeof opts.charset === 'undefined' ? defaults.charset : opts.charset;\n\n    return {\n        allowDots: typeof opts.allowDots === 'undefined' ? defaults.allowDots : !!opts.allowDots,\n        allowPrototypes: typeof opts.allowPrototypes === 'boolean' ? opts.allowPrototypes : defaults.allowPrototypes,\n        arrayLimit: typeof opts.arrayLimit === 'number' ? opts.arrayLimit : defaults.arrayLimit,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        comma: typeof opts.comma === 'boolean' ? opts.comma : defaults.comma,\n        decoder: typeof opts.decoder === 'function' ? opts.decoder : defaults.decoder,\n        delimiter: typeof opts.delimiter === 'string' || utils.isRegExp(opts.delimiter) ? opts.delimiter : defaults.delimiter,\n        // eslint-disable-next-line no-implicit-coercion, no-extra-parens\n        depth: (typeof opts.depth === 'number' || opts.depth === false) ? +opts.depth : defaults.depth,\n        ignoreQueryPrefix: opts.ignoreQueryPrefix === true,\n        interpretNumericEntities: typeof opts.interpretNumericEntities === 'boolean' ? opts.interpretNumericEntities : defaults.interpretNumericEntities,\n        parameterLimit: typeof opts.parameterLimit === 'number' ? opts.parameterLimit : defaults.parameterLimit,\n        parseArrays: opts.parseArrays !== false,\n        plainObjects: typeof opts.plainObjects === 'boolean' ? opts.plainObjects : defaults.plainObjects,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling\n    };\n};\n\nmodule.exports = function (str, opts) {\n    var options = normalizeParseOptions(opts);\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options, typeof str === 'string');\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    return utils.compact(obj);\n};\n","'use strict';\n\nvar utils = require('./utils');\nvar formats = require('./formats');\nvar has = Object.prototype.hasOwnProperty;\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) {\n        return prefix + '[]';\n    },\n    comma: 'comma',\n    indices: function indices(prefix, key) {\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) {\n        return prefix;\n    }\n};\n\nvar isArray = Array.isArray;\nvar push = Array.prototype.push;\nvar pushToArray = function (arr, valueOrArray) {\n    push.apply(arr, isArray(valueOrArray) ? valueOrArray : [valueOrArray]);\n};\n\nvar toISO = Date.prototype.toISOString;\n\nvar defaultFormat = formats['default'];\nvar defaults = {\n    addQueryPrefix: false,\n    allowDots: false,\n    charset: 'utf-8',\n    charsetSentinel: false,\n    delimiter: '&',\n    encode: true,\n    encoder: utils.encode,\n    encodeValuesOnly: false,\n    format: defaultFormat,\n    formatter: formats.formatters[defaultFormat],\n    // deprecated\n    indices: false,\n    serializeDate: function serializeDate(date) {\n        return toISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false\n};\n\nvar isNonNullishPrimitive = function isNonNullishPrimitive(v) {\n    return typeof v === 'string'\n        || typeof v === 'number'\n        || typeof v === 'boolean'\n        || typeof v === 'symbol'\n        || typeof v === 'bigint';\n};\n\nvar stringify = function stringify(\n    object,\n    prefix,\n    generateArrayPrefix,\n    strictNullHandling,\n    skipNulls,\n    encoder,\n    filter,\n    sort,\n    allowDots,\n    serializeDate,\n    formatter,\n    encodeValuesOnly,\n    charset\n) {\n    var obj = object;\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = serializeDate(obj);\n    } else if (generateArrayPrefix === 'comma' && isArray(obj)) {\n        obj = utils.maybeMap(obj, function (value) {\n            if (value instanceof Date) {\n                return serializeDate(value);\n            }\n            return value;\n        }).join(',');\n    }\n\n    if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ? encoder(prefix, defaults.encoder, charset, 'key') : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (isNonNullishPrimitive(obj) || utils.isBuffer(obj)) {\n        if (encoder) {\n            var keyValue = encodeValuesOnly ? prefix : encoder(prefix, defaults.encoder, charset, 'key');\n            return [formatter(keyValue) + '=' + formatter(encoder(obj, defaults.encoder, charset, 'value'))];\n        }\n        return [formatter(prefix) + '=' + formatter(String(obj))];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n        var value = obj[key];\n\n        if (skipNulls && value === null) {\n            continue;\n        }\n\n        var keyPrefix = isArray(obj)\n            ? typeof generateArrayPrefix === 'function' ? generateArrayPrefix(prefix, key) : prefix\n            : prefix + (allowDots ? '.' + key : '[' + key + ']');\n\n        pushToArray(values, stringify(\n            value,\n            keyPrefix,\n            generateArrayPrefix,\n            strictNullHandling,\n            skipNulls,\n            encoder,\n            filter,\n            sort,\n            allowDots,\n            serializeDate,\n            formatter,\n            encodeValuesOnly,\n            charset\n        ));\n    }\n\n    return values;\n};\n\nvar normalizeStringifyOptions = function normalizeStringifyOptions(opts) {\n    if (!opts) {\n        return defaults;\n    }\n\n    if (opts.encoder !== null && opts.encoder !== undefined && typeof opts.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    var charset = opts.charset || defaults.charset;\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n\n    var format = formats['default'];\n    if (typeof opts.format !== 'undefined') {\n        if (!has.call(formats.formatters, opts.format)) {\n            throw new TypeError('Unknown format option provided.');\n        }\n        format = opts.format;\n    }\n    var formatter = formats.formatters[format];\n\n    var filter = defaults.filter;\n    if (typeof opts.filter === 'function' || isArray(opts.filter)) {\n        filter = opts.filter;\n    }\n\n    return {\n        addQueryPrefix: typeof opts.addQueryPrefix === 'boolean' ? opts.addQueryPrefix : defaults.addQueryPrefix,\n        allowDots: typeof opts.allowDots === 'undefined' ? defaults.allowDots : !!opts.allowDots,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        delimiter: typeof opts.delimiter === 'undefined' ? defaults.delimiter : opts.delimiter,\n        encode: typeof opts.encode === 'boolean' ? opts.encode : defaults.encode,\n        encoder: typeof opts.encoder === 'function' ? opts.encoder : defaults.encoder,\n        encodeValuesOnly: typeof opts.encodeValuesOnly === 'boolean' ? opts.encodeValuesOnly : defaults.encodeValuesOnly,\n        filter: filter,\n        formatter: formatter,\n        serializeDate: typeof opts.serializeDate === 'function' ? opts.serializeDate : defaults.serializeDate,\n        skipNulls: typeof opts.skipNulls === 'boolean' ? opts.skipNulls : defaults.skipNulls,\n        sort: typeof opts.sort === 'function' ? opts.sort : null,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling\n    };\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = normalizeStringifyOptions(opts);\n\n    var objKeys;\n    var filter;\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (isArray(options.filter)) {\n        filter = options.filter;\n        objKeys = filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var arrayFormat;\n    if (opts && opts.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = opts.arrayFormat;\n    } else if (opts && 'indices' in opts) {\n        arrayFormat = opts.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = 'indices';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[arrayFormat];\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (options.sort) {\n        objKeys.sort(options.sort);\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (options.skipNulls && obj[key] === null) {\n            continue;\n        }\n        pushToArray(keys, stringify(\n            obj[key],\n            key,\n            generateArrayPrefix,\n            options.strictNullHandling,\n            options.skipNulls,\n            options.encode ? options.encoder : null,\n            options.filter,\n            options.sort,\n            options.allowDots,\n            options.serializeDate,\n            options.formatter,\n            options.encodeValuesOnly,\n            options.charset\n        ));\n    }\n\n    var joined = keys.join(options.delimiter);\n    var prefix = options.addQueryPrefix === true ? '?' : '';\n\n    if (options.charsetSentinel) {\n        if (options.charset === 'iso-8859-1') {\n            // encodeURIComponent('&#10003;'), the \"numeric entity\" representation of a checkmark\n            prefix += 'utf8=%26%2310003%3B&';\n        } else {\n            // encodeURIComponent('✓')\n            prefix += 'utf8=%E2%9C%93&';\n        }\n    }\n\n    return joined.length > 0 ? prefix + joined : '';\n};\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\nvar isArray = Array.isArray;\n\nvar hexTable = (function () {\n    var array = [];\n    for (var i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n\n    return array;\n}());\n\nvar compactQueue = function compactQueue(queue) {\n    while (queue.length > 1) {\n        var item = queue.pop();\n        var obj = item.obj[item.prop];\n\n        if (isArray(obj)) {\n            var compacted = [];\n\n            for (var j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n\n            item.obj[item.prop] = compacted;\n        }\n    }\n};\n\nvar arrayToObject = function arrayToObject(source, options) {\n    var obj = options && options.plainObjects ? Object.create(null) : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nvar merge = function merge(target, source, options) {\n    /* eslint no-param-reassign: 0 */\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object') {\n        if (isArray(target)) {\n            target.push(source);\n        } else if (target && typeof target === 'object') {\n            if ((options && (options.plainObjects || options.allowPrototypes)) || !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (!target || typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (isArray(target) && !isArray(source)) {\n        mergeTarget = arrayToObject(target, options);\n    }\n\n    if (isArray(target) && isArray(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                var targetItem = target[i];\n                if (targetItem && typeof targetItem === 'object' && item && typeof item === 'object') {\n                    target[i] = merge(targetItem, item, options);\n                } else {\n                    target.push(item);\n                }\n            } else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nvar assign = function assignSingleSource(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n};\n\nvar decode = function (str, decoder, charset) {\n    var strWithoutPlus = str.replace(/\\+/g, ' ');\n    if (charset === 'iso-8859-1') {\n        // unescape never throws, no try...catch needed:\n        return strWithoutPlus.replace(/%[0-9a-f]{2}/gi, unescape);\n    }\n    // utf-8\n    try {\n        return decodeURIComponent(strWithoutPlus);\n    } catch (e) {\n        return strWithoutPlus;\n    }\n};\n\nvar encode = function encode(str, defaultEncoder, charset) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = str;\n    if (typeof str === 'symbol') {\n        string = Symbol.prototype.toString.call(str);\n    } else if (typeof str !== 'string') {\n        string = String(str);\n    }\n\n    if (charset === 'iso-8859-1') {\n        return escape(string).replace(/%u[0-9a-f]{4}/gi, function ($0) {\n            return '%26%23' + parseInt($0.slice(2), 16) + '%3B';\n        });\n    }\n\n    var out = '';\n    for (var i = 0; i < string.length; ++i) {\n        var c = string.charCodeAt(i);\n\n        if (\n            c === 0x2D // -\n            || c === 0x2E // .\n            || c === 0x5F // _\n            || c === 0x7E // ~\n            || (c >= 0x30 && c <= 0x39) // 0-9\n            || (c >= 0x41 && c <= 0x5A) // a-z\n            || (c >= 0x61 && c <= 0x7A) // A-Z\n        ) {\n            out += string.charAt(i);\n            continue;\n        }\n\n        if (c < 0x80) {\n            out = out + hexTable[c];\n            continue;\n        }\n\n        if (c < 0x800) {\n            out = out + (hexTable[0xC0 | (c >> 6)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        if (c < 0xD800 || c >= 0xE000) {\n            out = out + (hexTable[0xE0 | (c >> 12)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        i += 1;\n        c = 0x10000 + (((c & 0x3FF) << 10) | (string.charCodeAt(i) & 0x3FF));\n        out += hexTable[0xF0 | (c >> 18)]\n            + hexTable[0x80 | ((c >> 12) & 0x3F)]\n            + hexTable[0x80 | ((c >> 6) & 0x3F)]\n            + hexTable[0x80 | (c & 0x3F)];\n    }\n\n    return out;\n};\n\nvar compact = function compact(value) {\n    var queue = [{ obj: { o: value }, prop: 'o' }];\n    var refs = [];\n\n    for (var i = 0; i < queue.length; ++i) {\n        var item = queue[i];\n        var obj = item.obj[item.prop];\n\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; ++j) {\n            var key = keys[j];\n            var val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n\n    compactQueue(queue);\n\n    return value;\n};\n\nvar isRegExp = function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar isBuffer = function isBuffer(obj) {\n    if (!obj || typeof obj !== 'object') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n\nvar combine = function combine(a, b) {\n    return [].concat(a, b);\n};\n\nvar maybeMap = function maybeMap(val, fn) {\n    if (isArray(val)) {\n        var mapped = [];\n        for (var i = 0; i < val.length; i += 1) {\n            mapped.push(fn(val[i]));\n        }\n        return mapped;\n    }\n    return fn(val);\n};\n\nmodule.exports = {\n    arrayToObject: arrayToObject,\n    assign: assign,\n    combine: combine,\n    compact: compact,\n    decode: decode,\n    encode: encode,\n    isBuffer: isBuffer,\n    isRegExp: isRegExp,\n    maybeMap: maybeMap,\n    merge: merge\n};\n"]}